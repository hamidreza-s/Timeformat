(function(){function t(t){var e={g_days_in_month:new Array(31,28,31,30,31,30,31,31,30,31,30,31),j_days_in_month:new Array(31,31,31,31,31,31,30,30,30,30,30,29),div:function(t,e){return Math.floor(t/e)},reminder:function(t,e){return t-this.div(t,e)*e},g_to_j:function(t){if(!t)return undefined;var e,n,r,i,a,s;var o,m,u;var h,d;var c;var l;e=t["year"]-1600;n=t["month"]-1;r=t["day"]-1;i=t["hours"];a=t["minutes"];s=t["seconds"];h=365*e+this.div(e+3,4)-this.div(e+99,100)+this.div(e+399,400);for(l=0;l<n;++l)h+=this.g_days_in_month[l];if(n>1&&(e%4==0&&e%100!=0||e%400==0))++h;h+=r;d=h-79;c=this.div(d,12053);d=this.reminder(d,12053);o=979+33*c+4*this.div(d,1461);d=this.reminder(d,1461);if(d>=366){o+=this.div(d-1,365);d=this.reminder(d-1,365)}for(l=0;l<11&&d>=this.j_days_in_month[l];++l){d-=this.j_days_in_month[l]}m=l+1;u=d+1;return{year:o,month:m,day:u,hours:i,minutes:a,seconds:s}},j_to_g:function(t){if(!t)return undefined;var e,n,r;var i,a,s,o,m,u;var h,d;var c;var l;i=t["year"]-979;a=t["month"]-1;s=t["day"]-1;o=t["hours"];m=t["minutes"];u=t["seconds"];d=365*i+this.div(i,33)*8+this.div(this.reminder(i,33)+3,4);for(l=0;l<a;++l)d+=this.j_days_in_month[l];d+=s;h=d+79;e=1600+400*this.div(h,146097);h=this.reminder(h,146097);c=1;if(h>=36525){h--;e+=100*this.div(h,36524);h=this.reminder(h,36524);if(h>=365)h++;else c=0}e+=4*this.div(h,1461);h=this.reminder(h,1461);if(h>=366){c=0;h--;e+=this.div(h,365);h=this.reminder(h,365)}for(l=0;h>=this.g_days_in_month[l]+(l==1&&c);l++)h-=this.g_days_in_month[l]+(l==1&&c);n=l+1;r=h+1;return{year:e,month:n,day:r,hours:o,minutes:m,seconds:u}},jalali_today:function(){Today=new Date;j=this.g_to_j({year:Today.getFullYear(),month:Today.getMonth()+1,day:Today.getDate(),hours:Today.getHours(),minutes:Today.getMinutes(),seconds:Today.getSeconds()});return;j["year"]+"/"+j["month"]+"/"+j["day"]+" "+j["hours"]+":"+j["minutes"]+":"+j["seconds"]},g_to_t:function(t){if(!t)return undefined;var e=new Date,n=t["year"],r=t["month"],i=t["day"],a=t["hours"],s=t["minutes"],o=t["seconds"];e.setYear(n);e.setMonth(r-1);e.setDate(i);e.setHours(a);e.setMinutes(s);e.setSeconds(o);return e.getTime().toString()},j_to_t:function(t){if(!t)return undefined;var e=this.j_to_g(t);return this.g_to_t(e)},t_to_j:function(t){if(!t)return undefined;var e=new Date(parseInt(t));return this.g_to_j({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})},t_to_g:function(t){if(!t)return undefined;var e=new Date(parseInt(t));return{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()}}};var n,r={miliseconds:false};t=t||{},currentT=(new Date).getTime(),currentJ=e.t_to_j(currentT),currentG=e.t_to_g(currentT),sections=["year","month","day","hours","minutes","seconds"],zero={year:0,month:0,day:0,hours:0,minutes:0,seconds:0,timestamp:0},seconds={year:31104e3,month:2592e3,day:86400,hours:3600,minutes:60,seconds:1,timestamp:1},targets=[];var i=function(t,e){var n={};for(var r in t){n[r]=t[r]}for(var r in e){n[r]=e[r]}return n};var a=function(t){var e=0;for(var n in t){if(!seconds.hasOwnProperty(n))continue;e+=seconds[n]*t[n]}return e};var s=function(){var t=new Event("new.timestamp");for(var e in targets){targets[e].dispatchEvent(t)}};if(t.timestamp)n=t.timestamp*1e3;else if(t.jalali)n=e.j_to_t(i(currentJ,t.jalali));else if(t.gregorian)n=e.g_to_t(i(currentG,t.gregorian));else n=(new Date).getTime();r=i(r,t);var o=new Date(parseInt(n));o.toTimestamp=function(){if(r.miliseconds)return this.getTime();return parseInt((this.getTime()/1e3).toFixed())};o.to=function(t,n){switch(t){case"jalali":if(!n)return e.t_to_j(this.getTime());if(sections.indexOf(n)==-1)return undefined;return e.t_to_j(this.getTime())[n];break;case"gregorian":if(!n)return e.t_to_g(this.getTime());if(sections.indexOf(n)==-1)return undefined;return e.t_to_g(this.getTime())[n];break}return this};o.from=function(t,n){switch(t){case"jalali":this.setTime(e.j_to_t(i(this.to(t),n)));break;case"gregorian":this.setTime(e.g_to_t(i(this.to(t),n)));break}s();return this};o.toJalali=function(t){return this.to("jalali",t)};o.toGregorian=function(t){return this.to("gregorian",t)};o.fromTimestamp=function(t){if(r.miliseconds)this.setTime(t);else this.setTime(t*1e3);s();return this};o.fromJalali=function(t){this.from("jalali",t);return this};o.fromGregorian=function(t){this.from("gregorian",t);return this};o.increment=function(t){var e=i(this.zero,t);var n=a(e);this.fromTimestamp(this.toTimestamp()+n);return this};o.decrement=function(t){var e=i(this.zero,t);var n=a(e);this.fromTimestamp(this.toTimestamp()-n);return this};o.formatJalali=function(t){return t.replace("{{y}}",this.toJalali("year")).replace("{{m}}",this.toJalali("month")).replace("{{d}}",this.toJalali("day")).replace("{{h}}",this.toJalali("hours")).replace("{{i}}",this.toJalali("minutes")).replace("{{s}}",this.toJalali("seconds"))};o.formatGregorian=function(t){return t.replace("{{y}}",this.toGregorian("year")).replace("{{m}}",this.toGregorian("month")).replace("{{d}}",this.toGregorian("day")).replace("{{h}}",this.toGregorian("hours")).replace("{{i}}",this.toGregorian("minutes")).replace("{{s}}",this.toGregorian("seconds"))};o.toString=function(){if(r.miliseconds)return"Timestamp "+this.getTime();return"Timestamp: "+(this.getTime()/1e3).toFixed()};o.html=function(t,e){var n=this;var e=e||{};var r=i({format:"jalali",year:{name:"year",cssClass:""},month:{name:"month",cssClass:""},day:{name:"day",cssClass:""},hours:{name:"hours",cssClass:""},minutes:{name:"minutes",cssClass:""}},e);var a=document.getElementById(t.replace("#",""));targets.push(a);a.addEventListener("new.timestamp",function(t){for(var e in a.childNodes){if(typeof a.childNodes[e]!="object")continue;a.childNodes[e].value=n.to(r.format,a.childNodes[e].getAttribute("timeformat"))}});if(e.year){var s=document.createElement("input");s.setAttribute("timeformat","year");s.name=r.year.name;s.type="text";s.placeholder="Year";s.className=r.year.cssClass;s.value=n.to(r.format,"year");s.addEventListener("change",function(t){n.from(r.format,{year:s.value})});a.appendChild(s)}if(e.month){var o=document.createElement("select");o.setAttribute("timeformat","month");o.name=r.month.name;o.className=r.month.cssClass;var m=[];for(var u=1;u<=12;u++){m[u]=document.createElement("option");m[u].textContent=m[u].value=u;o.appendChild(m[u])}var h=n.to(r.format,"month")-1;o.getElementsByTagName("option")[h].selected="selected";o.addEventListener("change",function(t){n.from(r.format,{month:o.value})});a.appendChild(o)}if(e.day){var d=document.createElement("input");d.setAttribute("timeformat","day");d.name=r.day.name;d.type="text";d.placeholder="Day";d.className=r.day.cssClass;d.value=n.to(r.format,"day");d.addEventListener("change",function(t){n.from(r.format,{day:d.value})});a.appendChild(d)}if(e.hours){var c=document.createElement("input");c.setAttribute("timeformat","hours");c.name=r.hours.name;c.type="text";c.placeholder="Hours";c.className=r.hours.cssClass;c.value=n.to(r.format,"hours");c.addEventListener("change",function(t){n.from(r.format,{hours:c.value})});a.appendChild(c)}if(e.minutes){var l=document.createElement("input");l.setAttribute("timeformat","minutes");l.name=r.minutes.name;l.type="text";l.placeholder="Minutes";l.className=r.minutes.cssClass;l.value=n.to(r.format,"minutes");l.addEventListener("change",function(t){n.from(r.format,{minutes:l.value})});a.appendChild(l)}return n};return o}window.Timeformat=t})();